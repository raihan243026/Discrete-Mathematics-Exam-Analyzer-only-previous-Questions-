<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discrete Mathematics Exam Analyzer</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Font Import -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* Define a custom color palette based on Tailwind theme, focusing on "Scholarly Neutrals" */
        :root {
            --primary: #363062; /* Darkest Blue-Violet (Headers, main text) */
            --secondary: #435585; /* Medium Blue (Accent, active filters) */
            --tertiary: #818FB4; /* Lighter Blue (Chart primary color) */
            --background: #f8f7f4; /* Off-White/Light Beige */
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background);
            color: #4a4a4a;
        }

        /* Responsive chart container for consistent aspect ratio */
        .chart-container {
            position: relative;
            height: 300px; /* Base height for mobile */
            width: 100%;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        
        /* Active state for filter buttons */
        .active-filter {
            background-color: var(--secondary) !important;
            color: #ffffff !important;
            box-shadow: 0 4px 6px -1px rgba(67, 85, 133, 0.3) !important; /* Custom shadow for accent color */
            transform: scale(1.02);
        }

        /* Interactive question card styling */
        .question-card {
            transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94), box-shadow 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        .question-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .filter-btn {
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            border: 1px solid #d1d5db; /* Light gray border for non-active state */
            white-space: nowrap; /* Prevents button text from wrapping */
        }
        .filter-btn:not(.active-filter):hover {
            background-color: #f3f4f6;
        }

    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto p-4 md:p-10 max-w-7xl">
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-extrabold text-[--primary]">Discrete Mathematics Exam Analyzer</h1>
            <p class="mt-3 text-lg text-gray-600 max-w-4xl mx-auto">An interactive study dashboard showing question patterns, topic frequency, and mark distribution from past exams (2023-2025) for course CCE-2307.</p>
        </header>

        <main>
            <!-- Key Metrics Section -->
            <section id="key-metrics" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
                <div class="bg-white p-6 rounded-2xl shadow-lg border border-gray-100 text-center transform hover:scale-[1.01] transition duration-300">
                    <h3 class="text-lg font-medium text-gray-500">Total Questions Analyzed</h3>
                    <p id="total-questions" class="text-5xl font-extrabold text-[--secondary] mt-2">0</p>
                </div>
                <div class="bg-white p-6 rounded-2xl shadow-lg border border-gray-100 text-center transform hover:scale-[1.01] transition duration-300">
                    <h3 class="text-lg font-medium text-gray-500">Frequently Repeated ("Common")</h3>
                    <p id="common-questions" class="text-5xl font-extrabold text-[--secondary] mt-2">0</p>
                </div>
                <div class="bg-white p-6 rounded-2xl shadow-lg border border-gray-100 text-center transform hover:scale-[1.01] transition duration-300">
                    <h3 class="text-lg font-medium text-gray-500">High-Potential ("Important")</h3>
                    <p id="important-topics" class="text-5xl font-extrabold text-[--secondary] mt-2">0</p>
                </div>
            </section>

            <!-- Charts Section -->
            <section class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
                <!-- Topic Frequency Chart -->
                <div class="bg-white p-6 rounded-2xl shadow-xl border border-gray-100">
                    <h2 class="text-2xl font-bold text-center mb-4 text-[--primary]">Question Count by Topic</h2>
                    <p class="text-center text-gray-600 mb-4 text-sm">Identifies topics with the highest number of past questions.</p>
                    <div class="chart-container">
                        <canvas id="topicFrequencyChart"></canvas>
                    </div>
                </div>
                <!-- Mark Distribution Chart -->
                <div class="bg-white p-6 rounded-2xl shadow-xl border border-gray-100">
                    <h2 class="text-2xl font-bold text-center mb-4 text-[--primary]">Mark Weightage Distribution</h2>
                    <p class="text-center text-gray-600 mb-4 text-sm">Shows the percentage of total marks assigned to each topic.</p>
                    <div class="chart-container">
                        <canvas id="marksDistributionChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Filter and Question List Section -->
            <section class="bg-white p-6 rounded-2xl shadow-xl border border-gray-100">
                <h2 class="text-3xl font-bold text-center mb-8 text-[--primary]">Filtered Question Explorer</h2>
                
                <!-- Filters: Centered and responsive flex container -->
                <div id="filters" class="flex flex-col md:flex-row flex-wrap items-center justify-center gap-4 mb-10 p-4 bg-gray-50 rounded-xl">
                    <!-- Topic Filters -->
                    <div class="flex flex-wrap justify-center gap-2">
                        <button data-filter="All" class="filter-btn topic-filter active-filter px-4 py-2 bg-gray-200 text-gray-700 rounded-full font-semibold">All Topics</button>
                        <button data-filter="Sets & Operations" class="filter-btn topic-filter px-4 py-2 bg-gray-200 text-gray-700 rounded-full font-semibold">Sets & Ops</button>
                        <button data-filter="Functions & Relations" class="filter-btn topic-filter px-4 py-2 bg-gray-200 text-gray-700 rounded-full font-semibold">Functions</button>
                        <button data-filter="Logic & Quantifiers" class="filter-btn topic-filter px-4 py-2 bg-gray-200 text-gray-700 rounded-full font-semibold">Logic</button>
                    </div>
                    
                    <!-- Status Filters -->
                    <div class="flex flex-wrap justify-center gap-2">
                        <button data-filter="All" class="filter-btn status-filter active-filter px-4 py-2 bg-gray-200 text-gray-700 rounded-full font-semibold">All Statuses</button>
                        <button data-filter="Common" class="filter-btn status-filter px-4 py-2 bg-gray-200 text-gray-700 rounded-full font-semibold">Common</button>
                        <button data-filter="Important" class="filter-btn status-filter px-4 py-2 bg-gray-200 text-gray-700 rounded-full font-semibold">Important</button>
                    </div>
                    
                    <!-- Semester Dropdown Filter -->
                    <div>
                        <select id="semester-filter" class="filter-btn semester-filter p-2 border border-gray-300 rounded-full font-semibold bg-white cursor-pointer hover:bg-gray-100">
                            <option value="All">All Semesters</option>
                        </select>
                    </div>
                </div>
                
                <!-- Question List Display -->
                <div id="question-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Cards will be injected here -->
                </div>
                
                <p id="no-results" class="text-center text-gray-500 py-10 text-lg hidden">No questions match the selected filters. Try broadening your criteria.</p>
            </section>
        </main>
    </div>

    <script>
        // Data source: Cleaned up question data for accuracy and to remove any potential math/LaTeX debris from the strings.
        const questionData = [
            { id: 1.1, topic: "Sets & Operations", text: "Discuss about different types of sets with examples.", marks: 6, semester: "Spring 2025", status: "Important" },
            { id: 1.2, topic: "Sets & Operations", text: "Find the sets and their bit strings. Let U = {0,1,...,9}, A = {2,4,6,8}, B = {1,3,5,7,9}, C = {2,3,5,7}. Find: i) A', ii) B ∪ C, iii) (A ∪ B) ∩ C, iv) (A ∩ B ∩ C).", marks: 4, semester: "Spring 2025", status: "Common" },
            { id: 1.3, topic: "Sets & Operations", text: "Implement Distributive Laws on the following sets: A = {1,2,3}, B = {3,4,5}, C = {3,5,6}.", marks: 6, semester: "Spring 2024", status: "" },
            { id: 1.4, topic: "Sets & Operations", text: "Prove that: i) A ∪ B = B ∪ A for A = {1,2} & B = {2,3,4}, ii) A ∩ B = B ∩ A for A = {1,2,3} & B = {2,5,6,7}.", marks: 4, semester: "Spring 2024", status: "" },
            { id: 1.5, topic: "Sets & Operations", text: "**Prove De Morgan's Laws:** i) (A ∪ B)' = A' ∩ B' and ii) (A ∩ B)' = A' ∪ B' for U = {1,...,9}, A = {2,4,6,8}, B = {2,3,5,7}.", marks: 6, semester: "Autumn 2023", status: "Common" },
            { id: 1.6, topic: "Sets & Operations", text: "Find the sets and bit strings of O ∪ P, U - P, E' and E ∪ (O ∪ P) for U = {0,1,...,9}, E = {2,4,6,8}, O = {1,3,5,7,9}, P = {2,3,5,7}.", marks: 4, semester: "Autumn 2023", status: "Common" },
            { id: 1.7, topic: "Sets & Operations", text: "Define Discrete Mathematics. Write down some applications of it.", marks: 3, semester: "Spring 2023", status: "" },
            { id: 1.8, topic: "Sets & Operations", text: "Use set builder notation to describe the given sets: i) A = {1,4,9,16,25,...}, ii) B = {2,4,8,16,32}.", marks: 3, semester: "Spring 2023", status: "" },
            { id: 1.9, topic: "Sets & Operations", text: "**Prove De Morgan's Laws:** i) (A ∪ B)' = A' ∩ B' ii) (A ∩ B)' = A' ∪ B' for U = {1,...,9}, A = {2,4,6,8}, B = {2,3,5,7}.", marks: 4, semester: "Spring 2023", status: "Common" },
            { id: 2.1, topic: "Functions & Relations", text: "Describe different types of relations with examples.", marks: 5, semester: "Spring 2025", status: "Important" },
            { id: 2.2, topic: "Functions & Relations", text: "Find out if the function f: R ↔ R, f(x) = 2x² - 5x + 1 is a one-to-one function?", marks: 5, semester: "Spring 2025", status: "" },
            { id: 2.3, topic: "Functions & Relations", text: "Which one is a one-one into function? i) f = {(1,a),(2,b),(3,c),(4,b)} ii) f = {(1,a),(2,b),(3,d)}", marks: 5, semester: "Spring 2025", status: "" },
            { id: 2.4, topic: "Functions & Relations", text: "Justify whether these two functions are one-one-onto or not: f = {(1,a), (2, c), (3, b), (4, d)}, g = {(1,a), (2, b), (3, b), (4.d)}.", marks: 4, semester: "Spring 2024", status: "Important" },
            { id: 2.5, topic: "Functions & Relations", text: "Given the sets A={1, 2, 3} and B={a, b, c, d}, classify whether the following relations are injective functions: f = {(1, a) (2, d) (3, b)}, g = {(1, a) (2, a) (3, d)}, h = {(1, a) (1, b) (2, d) (3, c)}, I = {(1, a) (2, b)}.", marks: 6, semester: "Spring 2024", status: "Common" },
            { id: 2.6, topic: "Functions & Relations", text: "Define injective, surjective, bijective and one-one into functions.", marks: 4, semester: "Autumn 2023", status: "Common" },
            { id: 2.7, topic: "Functions & Relations", text: "Given the sets A={1, 2, 3} and B={a, b, c, d}, classify whether the following relations are injective functions: f = {(1, a) (2, d) (3, b)}, g = {(1, a) (2, a) (3, d)}, h = {(1, a) (1, b) (2, d) (3, c)}, I = {(1, a) (2, b)}.", marks: 6, semester: "Autumn 2023", status: "Common" },
            { id: 2.8, topic: "Functions & Relations", text: "Define Functions. Explain different types of functions with examples.", marks: 6, semester: "Spring 2023", status: "Common" },
            { id: 2.9, topic: "Functions & Relations", text: "Show that the function f: R → R, given by f(x) = 2x, is one-one and onto.", marks: 4, semester: "Spring 2023", status: "Important" },
            { id: 3.1, topic: "Logic & Quantifiers", text: "Determine whether each of these conditional and biconditional statements is true or false. (Four specific examples given)", marks: 6, semester: "Spring 2025", status: "" },
            { id: 3.2, topic: "Logic & Quantifiers", text: "**Show logical equivalence of Contrapositive:** Show that conditional statement p → q and its contra positive (~q → ~p) are logically equivalent.", marks: 4, semester: "Spring 2025", status: "Common" },
            { id: 3.3, topic: "Logic & Quantifiers", text: "**Truth Values for Quantifiers:** Let P(x) be the statement x = x². What are the truth values of Universal and Existential quantifier for i) P(0), ii) P(2), iii) P(1), iv) P(-1).", marks: 5, semester: "Spring 2025", status: "Important" },
            { id: 3.4, topic: "Logic & Quantifiers", text: "**Prove Contrapositive Equivalence (Tautology):** Prove that, the statement (p → q) ↔ (~q → ~p) is a tautology.", marks: 5, semester: "Spring 2024", status: "Common" },
            { id: 3.5, topic: "Logic & Quantifiers", text: "Show the truth table for the derived connector **NAND**.", marks: 3, semester: "Spring 2024", status: "Important" },
            { id: 3.6, topic: "Logic & Quantifiers", text: "Show that proposition (p ↔ q) ≅ (p → q) ∧ (q → p).", marks: 5, semester: "Spring 2024", status: "Important" },
            { id: 3.7, topic: "Logic & Quantifiers", text: "Show the truth table for the derived connector **XOR**.", marks: 3, semester: "Spring 2024", status: "Important" },
            { id: 3.8, topic: "Logic & Quantifiers", text: "**Truth Value for Universal Quantifier:** Let, Q(x) be the statement 'x < 2'. Justify the truth values of ∀x Q(x) where the domain consists of all real numbers.", marks: 2, semester: "Spring 2024", status: "Common" },
            { id: 3.9, topic: "Logic & Quantifiers", text: "**Show logical equivalence of Contrapositive:** Show that p → q and its contra positive ~q → ~p are logically equivalent.", marks: 5, semester: "Autumn 2023", status: "Common" },
            { id: 3.10, topic: "Logic & Quantifiers", text: "Prove that X ⊕ Y ≅ (X ∧ ¬Y) ∨ (¬X ∧ Y).", marks: 4, semester: "Autumn 2023", status: "Important" },
            { id: 3.11, topic: "Logic & Quantifiers", text: "Show that proposition q → p, and ~p → ~q is not equivalent to p → q.", marks: 4, semester: "Autumn 2023", status: "" },
            { id: 3.12, topic: "Logic & Quantifiers", text: "**Truth Value for Universal Quantifier:** Let, Q(x) be the statement 'x < 2'. Justify the truth values of ∀x Q(x) where the domain consists of all real numbers.", marks: 2, semester: "Autumn 2023", status: "Common" },
            { id: 3.13, topic: "Logic & Quantifiers", text: "Define Propositional Logic. Convert the following sentence into logical expression: 'You can access the internet from campus only if you are a computer science major or you are not a freshman.'", marks: 5, semester: "Spring 2023", status: "Important" },
            { id: 3.14, topic: "Logic & Quantifiers", text: "Define Predicate and Quantifiers. Convert the following statements into mathematical statements using predicate logic: 'Every person who is 18 years or older, is eligible to vote.'", marks: 5, semester: "Spring 2023", status: "Important" },
            { id: 3.15, topic: "Logic & Quantifiers", text: "Define sets. Explain the representations of sets with examples.", marks: 4, semester: "Spring 2023", status: "Important" },
            { id: 3.16, topic: "Logic & Quantifiers", text: "Find the bit string for: i) A ∪ B, ii) A ∩ B, iii) U ∩ (A ∪ B) for U = {1,...,10}, A = {1,...,5}, B = {1,3,5,7,9}.", marks: 6, semester: "Spring 2023", status: "Common" }
        ];

        let topicChart, marksChart;
        let filters = { topic: 'All', status: 'All', semester: 'All' };

        // Color definitions for Chart.js
        const chartColors = {
            primary: '#435585', 
            secondary: '#818FB4', 
            tertiary: '#B4C5E4',
            light: '#E6E6FA'
        };

        document.addEventListener('DOMContentLoaded', () => {
            populateSemesterFilter();
            initializeCharts();
            updateDashboard();

            // Event Listeners for filters
            document.querySelectorAll('.topic-filter').forEach(button => button.addEventListener('click', (e) => setFilter(e, 'topic')));
            document.querySelectorAll('.status-filter').forEach(button => button.addEventListener('click', (e) => setFilter(e, 'status')));
            document.getElementById('semester-filter').addEventListener('change', (e) => {
                filters.semester = e.target.value;
                updateDashboard();
            });
        });

        function setFilter(event, filterType) {
            const button = event.target;
            filters[filterType] = button.dataset.filter;
            
            // Remove active class from all buttons of this type
            document.querySelectorAll(`.${filterType}-filter`).forEach(btn => btn.classList.remove('active-filter'));
            
            // Add active class to the clicked button
            button.classList.add('active-filter');
            
            // Update the dashboard with new filters
            updateDashboard();
        }

        function populateSemesterFilter() {
            // Extract unique semesters, sort them in reverse chronological order
            const semesters = [...new Set(questionData.map(q => q.semester))].sort().reverse();
            const select = document.getElementById('semester-filter');
            
            semesters.forEach(semester => {
                const option = document.createElement('option');
                option.value = semester;
                option.textContent = semester;
                select.appendChild(option);
            });
        }

        function filterData() {
            return questionData.filter(q => 
                (filters.topic === 'All' || q.topic === filters.topic) &&
                (filters.status === 'All' || q.status === filters.status) &&
                (filters.semester === 'All' || q.semester === filters.semester)
            );
        }

        function updateDashboard() {
            const filteredQuestions = filterData();
            // Key metrics remain static, based on ALL data
            updateKeyMetrics(); 
            // Charts and list update based on filtered data
            updateCharts(filteredQuestions);
            renderQuestionList(filteredQuestions);
        }

        function updateKeyMetrics() {
            // These metrics use the entire dataset for an overview
            document.getElementById('total-questions').textContent = questionData.length;
            document.getElementById('common-questions').textContent = questionData.filter(q => q.status === 'Common').length;
            document.getElementById('important-topics').textContent = questionData.filter(q => q.status === 'Important').length;
        }

        function renderQuestionList(questions) {
            const listElement = document.getElementById('question-list');
            const noResultsElement = document.getElementById('no-results');
            listElement.innerHTML = '';
            
            if (questions.length === 0) {
                noResultsElement.classList.remove('hidden');
                return;
            }
            noResultsElement.classList.add('hidden');
            
            questions.forEach(q => {
                let statusBadge = '';
                if (q.status === 'Common') {
                    statusBadge = `<span class="absolute top-3 right-3 text-xs font-semibold px-3 py-1 bg-blue-100 text-blue-800 rounded-lg shadow-sm">Common</span>`;
                } else if (q.status === 'Important') {
                    statusBadge = `<span class="absolute top-3 right-3 text-xs font-semibold px-3 py-1 bg-green-100 text-green-800 rounded-lg shadow-sm">Important</span>`;
                }

                const card = `
                    <div class="question-card bg-white border border-gray-200 rounded-xl p-5 flex flex-col relative h-full">
                        ${statusBadge}
                        <div class="mb-3">
                           <span class="text-xs font-bold text-gray-500 bg-gray-100 py-1 px-2 rounded">${q.semester}</span>
                        </div>
                        <p class="text-sm font-medium text-[--secondary] mb-2">${q.topic}</p>
                        <p class="text-base text-gray-700 font-semibold flex-grow mb-4">${q.text}</p>
                        <div class="flex justify-between items-end mt-auto pt-4 border-t border-gray-100">
                            <span class="text-lg font-extrabold text-[--primary]">${q.marks} Marks</span>
                        </div>
                    </div>
                `;
                listElement.innerHTML += card;
            });
        }

        function initializeCharts() {
            // Aggregate all unique topics from the original dataset for consistent labels
            const topics = [...new Set(questionData.map(q => q.topic))];
            
            // --- Topic Frequency Chart (Bar Chart) ---
            const topicCtx = document.getElementById('topicFrequencyChart').getContext('2d');
            topicChart = new Chart(topicCtx, {
                type: 'bar',
                data: { 
                    labels: topics, 
                    datasets: [{ 
                        label: 'Question Count', 
                        data: [], // Data populated in updateCharts
                        backgroundColor: chartColors.secondary,
                        hoverBackgroundColor: chartColors.primary,
                        borderRadius: 8,
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    plugins: { 
                        legend: { display: false },
                        tooltip: { mode: 'index', intersect: false }
                    }, 
                    scales: { 
                        y: { 
                            beginAtZero: true, 
                            ticks: { stepSize: 1, color: '#6b7280' },
                            grid: { color: '#f3f4f6' }
                        },
                        x: {
                            ticks: { color: '#6b7280' },
                            grid: { display: false }
                        }
                    } 
                }
            });

            // --- Marks Distribution Chart (Doughnut Chart) ---
            const marksCtx = document.getElementById('marksDistributionChart').getContext('2d');
            marksChart = new Chart(marksCtx, {
                type: 'doughnut',
                data: { 
                    labels: topics, 
                    datasets: [{ 
                        label: 'Total Marks', 
                        data: [], // Data populated in updateCharts
                        backgroundColor: [chartColors.primary, chartColors.secondary, chartColors.tertiary, chartColors.light, '#6c757d', '#adb5bd'], // Extended color palette
                        hoverOffset: 10,
                        borderWidth: 2,
                        borderColor: 'white',
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    plugins: { 
                        legend: { 
                            position: 'bottom',
                            labels: {
                                color: '#4a4a4a',
                                padding: 15,
                            }
                        } 
                    } 
                }
            });
        }

        function updateCharts(data) {
            // Determine all topics based on the full dataset (for consistent chart labels)
            const allTopics = [...new Set(questionData.map(q => q.topic))];

            // 1. Calculate Topic Counts (for Bar Chart)
            const topicCounts = allTopics.map(topic => 
                data.filter(q => q.topic === topic).length
            );
            
            // 2. Calculate Total Marks per Topic (for Doughnut Chart)
            const topicMarks = allTopics.map(topic => 
                data.filter(q => q.topic === topic).reduce((sum, q) => sum + q.marks, 0)
            );

            // Update Topic Frequency Chart
            topicChart.data.labels = allTopics;
            topicChart.data.datasets[0].data = topicCounts;
            topicChart.update();

            // Update Marks Distribution Chart
            marksChart.data.labels = allTopics;
            marksChart.data.datasets[0].data = topicMarks;
            marksChart.update();
        }
    </script>
</body>
</html>
